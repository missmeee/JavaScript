# 数据库
数据库有三种模型

- 层次模型
- 网状模型
- 关系模型
## SQL
SQL是结构化查询语言的缩写，用来访问和操作数据库系统。SQL语句既可以查询数据库中的数据，也可以添加、更新和删除数据库中的数据，还可以对数据库进行管理和维护操作。

SQL语言定义了这么几种操作数据库的能力：

**DDL：Data Definition Language**

DDL允许用户定义数据，也就是创建表、删除表、修改表结构这些操作。通常，DDL由数据库管理员执行。

**DML：Data Manipulation Language**

DML为用户提供添加、删除、更新数据的能力，这些是应用程序对数据库的日常操作。

**DQL：Data Query Language**

DQL允许用户查询数据，这也是通常最频繁的数据库日常操作。

## 数据类型
对于一个关系表，除了定义每一列的名称外，还需要定义每一列的数据类型。关系数据库支持的标准数据类型包括数值、字符串、时间等：


![](https://static.notedeep.com/FkLVhR8_MsxkQXZMlF3JOlNW3BSd)
# 关系模型
关系模型本质上就是若干个存储数据的二维表。

表的每一行称为记录（Record），记录是一个逻辑意义上的数据。

表的每一列称为字段（Column），同一个表的每一行记录都拥有相同的若干字段。

字段定义了数据类型（整型、浮点型、字符串、日期等），以及是否允许为NULL。注意NULL表示字段数据不存在。一个整型字段如果为NULL不表示它的值为0，同样的，一个字符串型字段为NULL也不表示它的值为空串' '。

在关系数据库中，关系是通过主键和外键来维护的。

## 主键
因为关系模型中不能存在两条完全相同的数据，所以需要选取某个字段来区分不同数据，这个字段被称为主键。

不要使用有任何功能性质的值作为主键，即选取主键时不要使用身份证，邮箱，电话这些看上去唯一的值。

常见的作为主键的值有：

自增整数类型：数据库会在插入数据时自动为每一条记录分配一个自增整数，这样我们就完全不用担心主键重复，也不用自己预先生成主键；
全局唯一GUID类型：使用一种全局唯一的字符串作为主键，类似`8f55d96b-8acc-4636-8cb8-76bf8abc2f57`。GUID算法通过网卡MAC地址、时间戳和随机数保证任意计算机在任意时间生成的字符串都是不同的，大部分编程语言都内置了GUID算法，可以自己预算出主键。
## 外键
在一个表中，使用某一个字段可以把数据和另一个表关联起来，这个字段被称为外键。

外键不是通过列名实现的，而是通过定义外键约束实现的。

定义外键约束：
```
ALTER TABLE students
ADD CONSTRAINT fk_class_id
FOREIGN KEY (class_id)
REFERENCES classes (id);
```
其中，外键约束的名称`fk\_class\_id`可以任意，`FOREIGN KEY (class\_id)`指定了`class\_id`作为外键，`REFERENCES classes (id)`指定了这个外键将关联到`classes`表的`id`列(即classes表的主键)。

要删除一个外键约束，也是通过ALTER TABLE实现的：
```
ALTER TABLE students
DROP FOREIGN KEY fk_class_id;
```
删除外键约束不会删除列，删除列要使用DROP\_COLUMN……实现。

由于外键约束会降低数据库的性能，大部分互联网应用程序为了追求速度，并不设置外键约束，而是仅靠应用程序自身来保证逻辑的正确性。

## 索引
索引是关系数据库中对某一列或多个列的值进行预排序的数据结构。通过使用索引，可以让数据库系统不必扫描整个表，而是直接定位到符合条件的记录，这样就大大加快了查询速度。

创建索引：
```
ALTER TABLE students
ADD INDEX idx_score (score);
```
使用`ADD INDEX idx_score(score)`就创建了一个名称为`idx_score`,使用`score`的索引。索引名称是任意的。索引如果有多列，可以在括号里依次写上，例如：
```
ALTER TABLE students
ADD INDEX idx_name_score (name, score);
```
索引的效率取决于索引列的值是否散列，即该列的值如果越互不相同，那么索引效率越高。